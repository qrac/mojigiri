import { describe, expect, it } from "vitest"

import mojigiri from "../src"

/* prettier-ignore */
export const example = "Introduction ministaï¼ˆãƒŸãƒ‹ã‚¹ã‚¿ï¼‰ã¯ã€React ã® JSX ã§æ›¸ã‘ã‚‹ã‚¹ã‚¿ãƒ†ã‚£ãƒƒã‚¯ã‚µã‚¤ãƒˆã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã§ã™ã€‚Next.js é¢¨ã®å¿«é©ãªç’°å¢ƒã§é–‹ç™ºã—ãªãŒã‚‰ 100% é™çš„ãªå‡ºåŠ›ã‚’è¡Œãˆã¾ã™ã€‚SaaS ã® web ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ¥­å‹™ã‚’æƒ³å®šã—ã¦ã„ã‚‹ãŸã‚ã€ãƒ“ãƒ«ãƒ‰å¾Œã®ãƒ‡ãƒ¼ã‚¿ãŒç¶ºéº—ï¼ˆãƒ’ãƒ¥ãƒ¼ãƒžãƒ³ãƒªãƒ¼ãƒ€ãƒ–ãƒ«ï¼‰ã§ã™ã€‚ History 2020 å¹´é ƒã«ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ä¸»æµãŒ Next.js ã«ãªã‚Šã¾ã—ãŸã€‚ã‚¨ãƒ‡ã‚£ã‚¿ã®è£œå®ŒãŒå„ªç§€ãª React ã® JSX ã§æ›¸ã‘ã¦å¿«é©ã§ã™ã€‚ãŸã ã€SPA ã‚’ä¸»è»¸ã¨ã—ã¦ã„ã‚‹ãŸã‚ç¶ºéº—ãª HTML ã‚’ç´å“ã™ã‚‹ SaaS é–‹ç™ºã«ã¯ä¸å‘ãã§ã™ã€‚ æœ€é©åŒ–ã•ã‚ŒãŸãƒãƒƒã‚·ãƒ¥ä»˜ä¸Žãƒ»ã‚³ãƒ¼ãƒ‰åˆ†å‰²ãƒ»preload ãªã©ã€SPA ç³»ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã«å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹é™çš„æ›¸ãå‡ºã—ã¯æ±‚ã‚ã¦ã„ã‚‹ã‚‚ã®ã¨é•ã„ã¾ã™ã€‚Nuxt ãŒæµè¡Œã£ã¦ã„ã‚‹é ƒã‹ã‚‰æ°—ã¥ã„ã¦ã„ã¾ã—ãŸã€‚ ã§ã¯ã€EJSãƒ»Pugãƒ»Nunjucks ã‚’å¼•ã£å¼µã‚Šå‡ºã—ã¾ã™ã‹ï¼Ÿã„ã„ãˆã€å½¼ã‚‰ã«ã¯ã¨ã¦ã‚‚åŠ©ã‘ã‚‰ã‚Œã¦ãã¾ã—ãŸãŒã€ä½¿ã„å¿ƒåœ°ãŒå¤§ããç•°ãªã‚‹ãŸã‚ Next.js ã¨ä¸¦è¡Œã—ã¦ä½¿ã„ç¶šã‘ã‚‹ã®ã¯è¾›ã„ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚ ãã“ã§ã€ç†æƒ³ã®å½¢ã‚’æ±‚ã‚ã¦ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’è©¦ä½œã€‚React ã® renderToStaticMarkup() ã¨ webpack ã‚’çµ„ã¿åˆã‚ã›ã¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã—ãŸã‚‚ã®ãŒåˆæœŸã® minista ã§ã™ã€‚ React(JSX)ã§æ›¸ã‘ã‚‹ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”¨ SSG - minista v0 React ã§æ›¸ã‘ã‚‹ SSG æ”¹å–„ç‚¹ã¨ä»Šå¾Œã«ã¤ã„ã¦ - minista v1 ä»•æ§˜ãŒå˜ç´”ã§æ‹¡å¼µã—ã‚„ã™ãå¤šæ•°ã®æ¥­å‹™ã§æ´»èºã—ã¦ãã‚Œã¾ã—ãŸï¼ãŸã ã€webpack ã¯èµ·å‹•æ™‚ã«ã™ã¹ã¦ã‚’ãƒãƒ³ãƒ‰ãƒ«ã—ã¦ãƒ¡ãƒ¢ãƒªã«ä¹—ã›ã‚‹è¨­è¨ˆãªã®ã§ã€å†…å®¹ãŒè†¨ã‚‰ã‚€ã»ã©ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ãŒæ‚ªåŒ–ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçµ‚ç›¤ã ã¨èµ·å‹•ã« 10 ç§’ä»¥ä¸Šã‹ã‹ã‚‹å ´åˆã‚‚ã‚ã‚Šæ‚©ã¿ã¾ã—ãŸã€‚ ã¾ãŸã€Next.js ã®ä½¿ã„å‹æ‰‹ã‚’å†ç¾ã§ãã¦ã„ãªã„éƒ¨åˆ†ã‚‚æ°—ã«ãªã£ã¦ã„ã¾ã—ãŸã€‚ä¾‹ãˆã°ã€ãƒšãƒ¼ã‚¸ã¯ HTML åŒ–ã™ã‚‹é–¢æ•°ãŒçœç•¥ä¸å¯ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯è‡ªèº«ã® CSS ã‚’ import ã§ããšã€fetch ã‹ã‚‰ã®ãƒ€ã‚¤ãƒŠãƒŸãƒƒã‚¯ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚„ Markdown çµ±åˆãªã‚“ã¦æ°—ã®é ããªã‚‹è©±ã«æ€ãˆã¾ã—ãŸã€‚ ãã‚“ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ã¨æ©Ÿèƒ½ã®å•é¡Œã‚’ã™ã¹ã¦è§£æ±ºã—ãŸã®ãŒ minista v2 ã§ã™ï¼webpack ã«ã¯æ„Ÿè¬ã—ã¤ã¤ã‚‚ä¸€æ—¦åˆ¥ã‚Œã‚’å‘Šã’ Vite ã¨ esbuild ã‚’çµ„ã¿è¾¼ã¿ã‚¼ãƒ­ã‹ã‚‰é–‹ç™ºã€‚ develop: v1-latest 9.1715s develop: v2.0.0 0.6006s (-93.45%) develop: v1-latest 10.7899s develop: v2.0.0 5.9628s (-44.73%) Example: { js: 319KB, css: 101KB, components: 38, pages: 15 } é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã¯è¦æ¨¡ã«é–¢ä¿‚ãªã 0.6 ç§’ã»ã©ã§ç«‹ã¡ä¸ŠãŒã‚Šã€æœ¬ç•ªãƒ“ãƒ«ãƒ‰ã®æ™‚é–“ã‚‚åŠåˆ†è¿‘ãçŸ­ç¸®ã€‚è¨­è¨ˆã‚’è¦‹ç›´ã—ãŸã“ã¨ã§ Next.js ã¨ã®è¦ªå’Œæ€§ã‚‚å¢—ã—ã€ã‚ˆã‚Šã‚¹ãƒˆãƒ¬ã‚¹ãªãé™çš„ã‚µã‚¤ãƒˆã‚’ä½œã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ Vite ã¨ esbuild ã‚’çµ„ã¿è¾¼ã¿ React è£½ SSG ã‚’å†æ§‹ç¯‰ - minista v2"

describe("mergeConfig", () => {
  it("Test: Example 1", () => {
    const result = mojigiri("æ—¥æœ¬èªžãƒ†ã‚­ã‚¹ãƒˆ100ã‚’ã€Œæ–‡å­—ã®ç¨®é¡žã€ã§splitã™ã‚‹ã€‚")

    //console.log("result", result)
    /* prettier-ignore */
    expect(result).toEqual(["æ—¥æœ¬èªž", "ãƒ†ã‚­ã‚¹ãƒˆ", "100", "ã‚’", "ã€Œ", "æ–‡å­—", "ã®", "ç¨®é¡ž", "ã€", "ã§", "split", "ã™ã‚‹", "ã€‚"])
  })

  it("Test: Example 2", () => {
    const text =
      "[number-:01]/index.tsx ã¨ã„ã† Next.jsã®ã‚ˆã†ãªReact(JSX)ã€‚Â©QRANOKO"
    const result = mojigiri(text)

    //console.log("result", result)
    /* prettier-ignore */
    expect(result).toEqual(["[","number","-",":","01","]","/","index",".","tsx"," ","ã¨ã„ã†"," ","Next",".","js","ã®ã‚ˆã†ãª","React","(","JSX",")","ã€‚","Â©","QRANOKO"])
  })

  it("Test: Example 3", () => {
    const text = "â€»æ³¨æ„ãƒ¡ãƒ‹ãƒ¥ãƒ¼"
    const result = mojigiri(text)

    //console.log("result", result)
    expect(result).toEqual(["â€»", "æ³¨æ„", "ãƒ¡ãƒ‹ãƒ¥ãƒ¼"])
  })

  it("Test: Example 4", () => {
    const text = "çµµæ–‡å­—âœ‹ã‚’ðŸŽ‰ðŸ‘æ¼¢å­—ã‚„ã‚«ãƒŠðŸ—’ã«ã€ŒðŸ‘ðŸ¥³ðŸ‘æ··ãœãŸã€å ´åˆ"
    const result = mojigiri(text)

    //console.log("result", result)
    /* prettier-ignore */
    expect(result).toEqual(["çµµæ–‡å­—","âœ‹","ã‚’","ðŸŽ‰ðŸ‘","æ¼¢å­—","ã‚„","ã‚«ãƒŠ","ðŸ—’","ã«","ã€Œ","ðŸ‘ðŸ¥³ðŸ‘","æ··","ãœãŸ","ã€","å ´åˆ"])
  })

  it("Test: One", () => {
    const text = "ãƒ†ã‚­ã‚¹ãƒˆ"
    const result = mojigiri(text)

    //console.log("result", result)
    expect(result).toEqual(["ãƒ†ã‚­ã‚¹ãƒˆ"])
  })

  it("Test: Null", () => {
    const text = ""
    const result = mojigiri(text)

    //console.log("result", result)
    expect(result).toEqual([])
  })
})
